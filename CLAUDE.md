# Takuya Sato Fansite - UI変更履歴

このファイルはUIに関わる変更の履歴を記録します。

## 2025-06-24 - 長期開催スケジュールの特別表示機能を追加

### 変更内容
開始日と終了日が異なる日程のスケジュール（1か月程度の会期等）を特別なカード表示する機能を実装しました。

### 変更詳細
- **API機能拡張**: `/pages/api/schedules/index.js`
  - `isLongTerm`フラグの判定ロジック追加（開始日≠終了日）
  - 終了日の整形処理追加（`endDate`, `endTime`プロパティ）

- **ホームページスケジュールセクション**: `/components/Schedule/Schedule.js`
  - 長期開催と通常スケジュールの分離表示
  - 「長期開催中」セクションを上部に固定表示
  - 期間表示バッジ（開始〜終了日）の実装

- **スケジュールページ**: `/pages/schedule.js`
  - 同様の長期開催カード表示機能を追加
  - 既存のタブフィルタリング機能との統合

### 表示仕様
- **期間表示バッジ**: 「会期中」バッジ + 開始日/終了日の表示
- **特別なカードデザイン**: グラデーション背景、左ボーダー強調
- **配置**: 長期開催スケジュールを上部、通常スケジュールを下部に表示
- **レスポンシブ対応**: モバイル表示でも適切にレイアウト調整

### CSSスタイル
新しいCSSクラス群を追加：
- `.long-term-schedules` - 長期開催セクション全体
- `.schedule-subsection-title` - 「長期開催中」セクション見出し
- `.long-term-card` - 長期開催カード（グラデーション背景）
- `.long-term-badge` - 期間表示バッジ（ピンクグラデーション）
- `.long-term-period-badge` - 「会期中」ラベル
- `.schedule-date-range` - 開始〜終了日の期間表示

### ファイル
- `/pages/api/schedules/index.js` - 長期開催判定ロジック
- `/components/Schedule/Schedule.js` - ホームページ長期開催表示
- `/pages/schedule.js` - スケジュールページ長期開催表示
- `/styles/globals.css` - 長期開催用CSSスタイル（4972-5071行目）

### 追加修正（会期状況の正確な判定）
- **会期判定ロジック**: 現在日付との比較により正確な状況判定
  - `ongoing`: 会期中（緑色バッジ）
  - `upcoming`: 開催予定（青色バッジ）
  - `ended`: 終了（グレーバッジ）
- **月跨ぎ対応**: 9月〜11月のイベントが9、10、11月の各タブに表示
- **検索ロジック拡張**: 3つの条件での複合検索により月跨ぎイベントを完全カバー
  - 開始日が検索期間内
  - 終了日が検索期間内（開始日が期間外でも）
  - 検索期間を完全包含（開始日が期間前、終了日が期間後）

### 効果
- 1か月程度の会期イベントを視覚的に分かりやすく表示
- 通常の単日スケジュールと明確に区別
- ユーザーが長期開催中のイベントを素早く認識可能
- 既存のタブフィルタリング機能と完全統合
- 月跨ぎイベントが該当する全ての月で表示される

## 2025-06-24 - スケジュールセクションに音声ガイドタブを追加

### 変更内容
ホームページのスケジュールセクションとscheduleページに音声ガイドタブを追加しました。

### 変更詳細
- **API拡張**: `/pages/api/schedules/index.js`
  - カテゴリマッピングに`'voice_guide': '音声ガイド'`を追加
  - カテゴリコード変換に音声ガイドの処理を追加

- **ホームページスケジュールセクション**: `/components/Schedule/Schedule.js`
  - 「音声ガイド」タブボタンを追加
  - タブフィルタリング機能に音声ガイドカテゴリを対応

- **スケジュールページ**: `/pages/schedule.js`
  - 「音声ガイド」タブボタンを追加（アクセシビリティ対応済み）
  - ARIA属性を適切に設定（`role="tab"`, `aria-selected`, `aria-controls`等）

### タブ構成（更新後）
1. すべて
2. イベント
3. 舞台・朗読
4. 生放送
5. **音声ガイド**（新規追加）

### ファイル
- `/pages/api/schedules/index.js` - API拡張
- `/components/Schedule/Schedule.js` - ホームページタブ追加
- `/pages/schedule.js` - スケジュールページタブ追加

### 効果
- 音声ガイド関連のイベントを独立したカテゴリで表示可能
- 既存のタブ構造と統一されたUIデザイン
- ユーザーが音声ガイドのスケジュールを簡単に絞り込み表示できる
- アクセシビリティに配慮したタブ実装

## 2025-06-16 - サイトタイトルロゴのモダンデザイン化

### 変更内容
サイトタイトルのロゴを今時のモダンなデザインに更新しました。

### 最終版デザイン
- グラデーションとアニメーションを削除してシンプルに
- メガネアイコン（FaGlasses）を追加
- サブタイトルを中央揃えに配置

### 変更詳細
- **メインタイトル（TAKUYA SATO）**:
  - フォントサイズ: `24px` → `28px`（モバイル: `22px` → `24px`）
  - フォントウェイト: `700` → `800`
  - 文字間隔: `2px` → `-0.5px`（より詰まった現代的な間隔）
  - 色: var(--primary-color)の単色に統一
  - メガネアイコン（FaGlasses）を左側に配置
  - ホバー時: メガネアイコンが少し回転（-5度）

- **サブタイトル（非公式ファンサイト）**:
  - フォントサイズ: `12px` → `11px`
  - 背景: なし → 薄いピンクの背景とボーダー付きバッジスタイル
  - パディング: なし → `4px 12px`
  - 角丸: なし → `20px`（ラウンド型バッジ）

- **アクセントライン**:
  - 高さ: `8px` → `2px`
  - 幅: `40%` → ホバー時に`0%`から`100%`へアニメーション
  - 色: 単色 → グラデーション（青→ピンク）

- **フォントファミリー**:
  - システムフォントを優先的に使用（-apple-system, BlinkMacSystemFont等）

### ファイル
- `/styles/globals.css` (2716-2804行目)

### 効果
- よりシンプルで洗練された印象
- メガネアイコンで個性的なアクセントを追加
- バッジスタイルのサブタイトルで階層感を演出
- 中央揃えの配置で統一感のあるデザイン
- ホバー時の控えめな動きで使いやすさを向上

## 2025-06-16 - モバイルメニューの上部間隔調整

### 変更内容
モバイル表示でサイトロゴと最初のメニュー項目（HOME）の間隔が狭すぎる問題を解決しました。

### 変更詳細
- **モバイルナビゲーションの上部パディング**: `80px` → `100px`
- **最初のメニュー項目の上部マージン**: `0` → `20px`を追加

### ファイル
- `/styles/globals.css` (1630行目、1638-1642行目)

### 効果
- サイトロゴとメニューの間に適切な余白を確保
- 視覚的な圧迫感を解消

## 2025-06-15 - モバイルメニューの間隔調整

### 変更内容
モバイル表示でメニューの下部が見切れる問題を解決するため、メニューの間隔を縮小しました。

### 変更詳細
- **メニュー項目間の間隔**: `margin: 20px 0` → `margin: 15px 0`
- **リンクのパディング**: `padding: 10px` → `padding: 8px`
- **フォントサイズ**: `font-size: 24px` → `font-size: 22px`

### ファイル
- `/styles/globals.css` (1641行目、1649行目、1646行目)

### 効果
- メニュー全体の縦幅を約40-50px縮小
- 小さなモバイル画面でも全てのメニュー項目が表示されるように改善

## 2025-06-19 - 楽曲一覧ページの追加とタブ構造への変更

### 変更内容
佐藤拓也さんの楽曲データを表示する楽曲一覧ページを新規追加し、/worksページと同様のタブ構造に変更しました。

### 変更詳細
- **新規ページ**: `/pages/songs.js`
- **APIエンドポイント**: `/pages/api/songs.js`
- **メニュー追加**: ナビゲーションメニューにSONGSを追加
- **デザイン統一**: /worksページのタブ構造とリストデザインに統一

### タブ構造
- **キャラクターソング**: オープニング、エンディング、挿入歌、キャラクターソング
- **本人名義楽曲**: ソロ楽曲、デュエット、グループ楽曲、カバー楽曲、オリジナル楽曲、テーマソング

### 機能
- 楽曲の一覧表示（タイトル、アーティスト、楽曲タイプ、作詞・作曲・編曲者など）
- タブ切り替えによるカテゴリ別表示
- /worksページと統一されたUIデザイン
- SEO対応（構造化データ含む）
- タブごとのメタデータ動的生成

### 表示構造
楽曲の表示順序（/worksページと同じ構造）：
1. 楽曲タイトル（`item-title`）
2. アーティスト名（`item-role`） - PC・モバイル共にタイトルの下の行に表示
3. リリース年（`item-year`）
4. 作詞・作曲・編曲者情報（`item-detail`） - 作詞 → 作曲 → 編曲の順

### レイアウト調整（2025-06-19）
- PC表示でもアーティスト名をタイトルの下の行に表示するようにCSSを調整
- `.list-item`を`flex-direction: column`に変更（全画面サイズ対応）
- 楽曲情報の各行間隔を広く調整：
  - `.item-role`のマージン: `5px` → `8px`
  - `.item-year`のマージン: `5px` → `8px`
  - `.item-detail`クラスを新規追加（`margin-top: 8px`）

### データ表示の修正（2025-06-19）
- アーティスト名が「artist」という文字列の場合は表示しないようにフィルタリングを追加
- `song.artist !== 'artist'`の条件でデータベースの不適切な値を除外
- 楽曲タイプバッジ（`song-type-badge`）を削除（タブで既に分類されているため冗長）

### メニュー構成の変更（2025-06-19）
- ヘッダーメニューからLINKSを削除（PC・モバイル両方）
- ナビゲーションの簡素化

### 表示順序の調整（2025-06-19）
- 作詞・作曲・編曲者情報の表示順序を変更
- 変更前: 作曲 → 作詞 → 編曲
- 変更後: 作詞 → 作曲 → 編曲

### ファイル
- `/pages/songs.js` - メインページコンポーネント（タブ構造に変更）
- `/pages/api/songs.js` - APIエンドポイント（カテゴリ別データ返却に変更）
- `/components/Navbar/Navbar.js` - メニューリンク追加

### データベース連携
- `songs`テーブルから楽曲データを取得
- `mst_staff`テーブルとの結合により作詞・作曲・編曲者情報を表示
- `song_type`による自動分類（キャラクターソング/本人名義楽曲）

### 楽曲分類ロジック
- **キャラクターソング**: `character`, `op`, `ed`, `insert`
- **本人名義楽曲**: `solo`, `duet`, `group`, `cover`, `original`, `theme`
- 分類不明の楽曲は本人名義楽曲に含める

### 効果
- /worksページとの一貫したユーザー体験
- 楽曲カテゴリの明確な分類
- タブ構造による見やすい情報整理
- データベースベースの動的コンテンツ提供

## 2025-06-21 - WORKSセクションと/worksページに音響監督情報を追加

### 変更内容
ホームページのWORKSセクションと/worksページの各作品に音響監督の名前を表示するように機能を追加しました。

### 変更詳細
- **データベースクエリの拡張**: `rel_work_staff`テーブルから音響監督情報を取得
- **APIの更新**: `/api/works.js`に音響監督データを含むクエリを追加
- **フロントエンドの更新**: 
  - ホームページのWORKSセクション（`/components/Works/Works.js`）
  - /worksページ（`/pages/works.js`）
- **データフォーマット**: `mst_staff_roles`で「音響監督」のスタッフのみを抽出
- **表示形式**: "音響監督: {名前1}、{名前2}" として表示

### 技術的詳細
- **データベース関連**: `rel_work_staff`テーブルと`mst_staff_roles`テーブルを結合
- **音響監督フィルタリング**: `workStaff.role?.name === '音響監督'`で絞り込み
- **複数音響監督対応**: 複数の音響監督がいる場合は「、」で区切って表示

### CSSスタイル
新しいCSSクラス `.item-sound-director` を追加：
- フォントサイズ: `13px`
- 色: `var(--gray-medium)`
- スタイル: イタリック体
- 透明度: `0.9`
- 上マージン: `6px`

### ファイル
- `/pages/api/works.js` - 音響監督データ取得ロジック追加
- `/components/Works/Works.js` - ホームページWORKSセクション表示追加
- `/pages/works.js` - /worksページ表示追加
- `/styles/globals.css` - 音響監督表示用CSSスタイル追加

### 効果
- 作品の制作スタッフ情報をより詳しく表示
- ユーザーが音響監督の情報も確認できるように
- 既存のデザインと調和した控えめな表示

## 2025-06-23 - 出演作品に公式サイトリンクアイコンを追加

### 変更内容
ホームページの出演作品セクションと/worksページの各作品に公式サイトへのリンクアイコンを表示する機能を追加しました。

### 変更詳細
- **APIエンドポイント拡張**: `/api/works.js`の全てのクエリに`official_url`フィールドを追加
- **データ構造更新**: `formatWork`関数と`formatRadioWork`関数にofficialUrlプロパティを追加
- **UIコンポーネント更新**:
  - ホームページWORKSセクション（`/components/Works/Works.js`）
  - /worksページ（`/pages/works.js`）
- **アイコン**: React Icons の `FaExternalLinkAlt` を使用
- **レイアウト**: 作品タイトルと公式サイトリンクを横並びで表示する`item-header`クラスを追加

### 技術的詳細
- **データソース**: `works`テーブルの`official_url`フィールド
- **条件表示**: `item.officialUrl`が存在する場合のみアイコンを表示
- **リンク属性**: `target="_blank" rel="noopener noreferrer"`で安全な外部リンク
- **全セクション対応**: アニメ、ゲーム、吹き替え、その他の全カテゴリに対応

### CSSスタイル
新しいCSSクラス：
- **`.item-header`**: タイトルとリンクアイコンの横並びレイアウト
- **`.official-link`**: スケジュールカードのボタンスタイルに統一
  - サイズ: `36px × 36px`
  - 背景: 白、ボーダー: プライマリーカラー
  - フォントサイズ: `16px`
  - ホバー時: 背景がプライマリーカラー、テキストが白、わずかに上移動

### ファイル
- `/pages/api/works.js` - official_url取得クエリ追加
- `/components/Works/Works.js` - ホームページ公式リンクアイコン追加
- `/pages/works.js` - /worksページ公式リンクアイコン追加
- `/styles/globals.css` - アイコン用CSSスタイル追加

### 効果
- 各作品の公式サイトへ簡単にアクセス可能
- 視覚的に分かりやすいアイコン表示
- ユーザビリティの向上
- 外部サイトへの安全な遷移

## メニュー構成
現在のメニュー項目（8項目）：
1. HOME
2. SCHEDULE
3. WORKS
4. VIDEO
5. CHARACTERS
6. EVENT MAP
7. SONGS
8. SOCIAL